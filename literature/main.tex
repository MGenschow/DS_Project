% document class

\documentclass[12pt]{article}


% use packages

\usepackage[utf8]{inputenc}
\usepackage{hyperref}
\usepackage[ddmmyyyy]{datetime}
\usepackage{color}
\usepackage{xcolor}
\usepackage{hyperref}
\hypersetup{
colorlinks=true,
linkcolor=[RGB]{0,51,102},
citecolor=[RGB]{0,51,102},
urlcolor=[RGB]{74, 133, 150}
}
\usepackage[medium]{titlesec}
\usepackage{geometry}
\usepackage{xurl}
\usepackage{natbib}
\usepackage{amsmath}
\usepackage{booktabs} % for addlinespace
\usepackage{float} % for table adjustment
\usepackage{tabularx}
\usepackage[acronym]{glossaries} % for abbreviation glossary

% adjust settings
\bibliographystyle{apalike}
\setlength{\bibsep}{0pt plus 0.3ex}
\newcommand\notype[1]{\unskip}
\usepackage{etoolbox}
\makeatletter
\patchcmd{\NAT@citex}
  {\@citea\NAT@hyper@{%
     \NAT@nmfmt{\NAT@nm}%
     \hyper@natlinkbreak{\NAT@aysep\NAT@spacechar}{\@citeb\@extra@b@citeb}%
     \NAT@date}}
  {\@citea\NAT@nmfmt{\NAT@nm}%
   \NAT@aysep\NAT@spacechar\NAT@hyper@{\NAT@date}}{}{}
\patchcmd{\NAT@citex}
  {\@citea\NAT@hyper@{%
     \NAT@nmfmt{\NAT@nm}%
     \hyper@natlinkbreak{\NAT@spacechar\NAT@@open\if*#1*\else#1\NAT@spacechar\fi}%
       {\@citeb\@extra@b@citeb}%
     \NAT@date}}
  {\@citea\NAT@nmfmt{\NAT@nm}%
   \NAT@spacechar\NAT@@open\if*#1*\else#1\NAT@spacechar\fi\NAT@hyper@{\NAT@date}}
  {}{}
 \makeatother
\newgeometry{
lmargin=2.5cm,
rmargin=2.5cm,
tmargin=2.5cm,
bmargin=2.5cm
}
\pagenumbering{arabic}

% configure title
\title{\vspace{-2cm} Data Science Project \\ Modeling urban heat intensity}
\author{Malte Genschow\thanks{malte.genschow@student.uni-tuebingen.de} , Stefan Glaisner\thanks{stefan.glaisner@student.uni-tuebingen.de} , Stefan Grochowski\thanks{stefan.grochwoski@student.uni-tuebingen.de} , Aaron Lay\thanks{aaron.lay@student.uni-tuebingen.de}}
\date{\today}

% configure glossary
\makeglossaries
\newacronym{lst}{LST}{Land surface temperature}
\newacronym{lclu}{LCLU}{Land cover and land usage}
\newacronym{mse}{MSE}{Mean squared error}
\newacronym{ndvi}{NDVI}{Normalized vegetation index}
\newacronym{sma}{SMA}{Spectral mixture analysis}
\newacronym{uhi}{UHI}{Urban heat intensity}

 % document
 
\begin{document}
\maketitle

\defcitealias{dwd2017}{\textcolor{black}{(DWD, }2017\textcolor{black}{)}}
\defcitealias{isprs2012}{\textcolor{black}{(ISPRS, }2012\textcolor{black}{)}}


\section{Introduction}

Urban heat islands have become an increasingly important topic given the advent of climate change and increasing urbanisation. High temperatures are not only inevitably associated with negative consequences for human health \citep{anderson2009,basu2002,basu2009} but also considerably restrict people in their daily lifes, whether at work or in their leisure time. This project within the context of the module \emph{DS500 Data Science Project} at the University of Tübingen aims at identifying urban heat islands in the city of Munich and modeling the relationship between urban heat intensity (\acrshort{uhi}) and potential causative factors - mainly derived from land cover and land use characteristics.


\section{Urban heat islands}

Neighbourhoods with a high building density often do not cool down sufficiently at night - the heat accumulates and becomes a health risk for the residents. Scientists call this phenomenon the urban heat island effect. During evening and night hours, the difference in temperatures between the city and the suburbs can sometimes be greater than 5°C. In inner cities, the risk of a tropical night (a night with minimum temperature above 20°C) is thus considerably higher. So-called tropical nights with temperatures above 20°C put a strain on the body because the heat makes it difficult to regenerate during sleep. But heat is not only a permanent challenge at night, but also during the day - which is what makes it so dangerous. Fluid loss can lead to circulatory problems, vascular occlusion and, in the worst case, heart or kidney failure. If the body is no longer able to sweat sufficiently, there is a risk of fatal overheating.

The urban heat island effect is therefore particularly problematic if temperatures are high on consecutive days \citep{gasparrini2011}. Such periods are also conventionally referred to as heat waves. Therefore, our analysis of urban heat intensity is based on temperature data that was recorded during the time of a heat wave. However, there are many ways to characterise periods as heat waves. We would like to highlight two methods in particular, one of which we have used.


\section{Heat wave detection}

When defining heat waves, researchers often do not only consider simple temperature measurements but draw back on the concept on apparent temperature $T_a$ as proposed by \citet{steadman1984}. $T_a$ generally represents a combination of relative humidity $H$ and temperature $T$.

How these two measurements are combined to one apparent temperature estimate can differ. One of the most famous proposals is the one by \citet{el2007}:
\begin{equation}
\begin{aligned}
HIF = & -42.379 + 2.0490T + 10.1433H + (-0.2248)TH + (-6.8378 \times 10^{-3})T^2 \\
& + (-5.4817 \times 10^{-2})H^2 + (1.2287 \times 10^{-3})T^2H + (8.5282 \times 10^{-4})TH^2 \\
& + (-1.99 \times 10^{-6})T^2H^2
\end{aligned}
\end{equation}

Another prominent index was developed by \citet{nws2011}. It is based on various nested conditions and is nicely described in \citet{anderson2013}. These estimates of apparent temperature can then be used for the detection of heatwaves which is thoroughly described in the next section.

\subsection{Annual series method}

The first heat waves identification and most standard method that we present here is the annual series method which has been applied quite frequently in the literature. One of the first and most prominent applications is the one by \citet{karl1997}. This method assesses either minimum nighttime temperatures or maximum daytime temperatures over a predefined time range, mostly a calendar year. Whether to concentrate on day- or nighttime is a conceptual decision. However, most of the literature deems very warm nights as even more impactful compared to very warm days concerning health risks \citep{mcmichael1996,henschel1969}. 

\subsection{Threshold method}

An alternative definition solely concentrates on the daytime maximum temperate meeting certain limits for some number of consecutive days. This - let's call it 'threshold method' - goes back to \citet{huth2000} and can also be found in many meteorological papers \citep{meehl2004,kysely2004,kysely2010}. The exact definition goes as follows: A heat wave is detected as soon as a temperature of $T_1$ is exceeded for at least three consecutive days and lasts as long as the average maximum temperature $T_{MAX}$ remains above $T_1$ and does not fall below a maximum temperature of $T_2$ on any day. \\
We chose 25°C for $T_2$ and 30°C for $T_1$ following the literature that deals with temperatures in Central Europe (e.g. \citet{kysely2004} focusing on the Czech Republic). \\
Using this approach and data from the Munich central DWD weather station for 2022 \citetalias{dwd2017}, we identified three periods of heatwaves: June 18-21, July 18-20 and August 03-05.

\subsection{Recurrence probabilities}

There has been several approaches to add some substance to the mere identification of heat waves by testing their statistical significance based on recurrence probability estimates. We follow \citet{mearns1984} and \citet{kysely2010} by fitting an ARMA(1,1) process to daily maximum temperatures observed from 2014 to 2022 in the months of June, July and August. Comparing the actually observed data for 2022 to 100,000 simulations of the estimated time series model suggests that all the heatwaves and in particular the one in July was highly statistically significant and quite unlikely in its nature.


\section{Modeling urban heat intensity}

\subsection{Urban heat intensity}

The main variable of interest considering our research question is urban heat intensity. Similarly to the vast majority of the literature, we concentrate on surface/skin UHI \citep{deilami2018}. Typically, UHI is defined as the difference of land surface temperature (\acrshort{lst}) between urban/built-up areas and non-urban/rural areas. However, we follow many other research papers by not focusing on the UHI specifically but by exploring the relationship between LST and selected spatial-temporal factors \citep{deilami2018}.\\
Another potential and somewhat new approach would be to consider the difference between day- and nighttime temperatures as - according to the urban heat island effect - we would expect to see a smaller difference for urban heat islands than elsewhere (as urban heat islands do not cool down at night). Nevertheless, in the end we opted for the former approach as there was too little heterogeneity in the day-nighttime-differential.

\subsection{Feature engineering}

One of the key aspects of this data science project is to complement the identification of heat islands with the identification of potential causative factors that drive them. Hence, the extraction of features from official property data and orthophotos provided by the Bavarian State Office for Digitisation, Broadband and Surveying \citep{bayern2018}. The official ready-to-use (i.e. already classified) data is complemented by a deep neural network that was fine-tuned using supervised classification to predict granular land cover and land usage characteristics (\acrshort{lclu}) for the unlabeled Munich data set. The deep learning model was trained using the LoveDA dataset \citep{loveda2021}. The extracted features here are first of all continuous and refer to the proportion of the area occupied by the LCLU pattern. Hence, the values for these features lie in the range between 0 and 1. Classified patterns are roads, trees, water, buildings, low vegetation and impervious surface.\\
As a proxy for winds, we have included the average height of buildings as an additional control variable in our model. The data comes from a 3D model provided by the Bavarian State Office for Digitisation, Broadband and Surveying \citep{bayern2018} as well. Accordingly, this variable is not limited upwards by 1.

\subsection{Causal model}

\citet{deilami2018} point out that that in the empirical literature on the relationship of UHI and potential causative factors, OLS is the predominant methodological approach together with the Pearson correlation coefficient. However, we emphasise that both methods are not capable of accounting for all the interactions and nonlinearities that are present in our ecosystem. Furthermore, we are also not interested in a simple treatment effect estimate but rather care about modeling "What If" scenarios (e.g. what would this inner city area would look like if there were more trees).\\
Still, the dependent/target variable $Y$ in our context is UHI measured by LST. Our feature set $X$ consists of various LCLU characteristics that were thoroughly described in the section above. Unfortunately, our model only incorporates spatial heterogeneity and cannot account for temporal variation, too, as, for instance, done by \citet{seebacher2019}. This is because the orthophotos were only available for a certain point of time, namely tbd. Since a large part of our feature set is based on this data source, we have no temporal heterogeneity here. However, even over a period of several years, we would not expect any major changes here, as a cityscape changes only very slowly and the temporal variation would be minimal anyway.

Both $Y$ and $X$ are observed for a predefined bounding box around Munich. Thus, we are talking about a very large observation that is limited in granularity by the coarsest pixel resolution. In our case, this refers to the LST data \citep{ecostress2019} where one pixel measures 70m by 70m. Given this constraint, we now divide our one large observation into several small observations by dividing our bounding box around Munich into a grid of several small 100m by 100m sections. For each grid element, we can now disaggregate our $Y$ and $X$ estimates.\\
Let us now denote a single 100m by 100m grid element by subscript $i$. Our goal is now to best approximate our conditional expectation function $E[ Y \mid X ]$. Put differently, the LST for grid element $i$ can be represented as a function of features $X_i$ and some unobserved error term:
\begin{equation}
Y_i = f(X_i) + u_i
\end{equation}
We can think of $f(\cdot)$ being any (non)-linear prediction function from our Machine Learning toolbox. However, to be able to establish causal interpretations, we employ a linear regression model that incorporates poylnomials and interactions of order 3 for all features to account for non-linearities and interactions.


\section{Limitations}

\citet{deilami2018} point to the fact that our world is three-dimensional and features such as tree canopy compared to vegetation area might hold more explanatory power with regard to UHI.

Considering the feature engineering, one potential advantageous approach would be to employ a soc-called spectral mixture analysis (\acrshort{sma}) to account for the fact that a single pixel might be partly covered by vegetation and impervious surface at the same time \citep{ridd1995}. However, given the very high 40cm resolution of the orthophotos, this might be negligible here.

\section{Accessibility of Results}

Our statistical analysis as well as the data preparation code can be found in our \href{https://github.com/MGenschow/DS_Project}{Github repository}. The final app that visualises our findings for the city of Munich is available \href{https://github.com/MGenschow/DS_Project}{here}.


\newpage
\printglossary[type=\acronymtype, nonumberlist, title={Abbreviations}]

\newpage
\pagenumbering{Roman}
\bibliography{ref}

\end{document}